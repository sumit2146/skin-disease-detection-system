{% extends "base.html" %}

{% block content %}
<div class="upload-wrapper" style="margin-top: 4rem;">
    <div class="text-center mb-4">
        <h2>New Skin Analysis</h2>
        <p style="color: var(--text-muted);">Upload a clear photo of the affected skin area for instant AI analysis.</p>
    </div>

    <form method="POST" enctype="multipart/form-data">
        <div class="upload-area" onclick="document.getElementById('file').click()">
            <input type="file" id="file" name="file" class="hidden-input" accept="image/*" capture="environment"
                required style="display: none;">

            <div id="upload-placeholder">
                <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"
                    class="upload-icon">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                    <polyline points="17 8 12 3 7 8"></polyline>
                    <line x1="12" y1="3" x2="12" y2="15"></line>
                </svg>
                <h3 style="margin-bottom: 0.5rem; color: var(--gray-700);">Click or Drag & Drop</h3>
                <p style="color: var(--text-muted);">Supports JPG, PNG (Max 5MB)</p>
            </div>

            <img id="preview"
                style="max-width: 100%; max-height: 400px; display: none; margin: 0 auto; border-radius: var(--radius-lg); box-shadow: var(--shadow-sm);">
        </div>

        <div class="form-row" style="display: flex; gap: 1rem; margin-top: 1.5rem;">
            <div class="form-group" style="flex: 1;">
                <label for="age" style="font-weight: 600; color: var(--gray-700); margin-bottom: 0.5rem; display: block;">Age</label>
                <input type="number" name="age" id="age" class="form-control" placeholder="e.g. 25" min="0" max="120"
                    style="width: 100%; padding: 0.75rem; border: 1px solid var(--gray-200); border-radius: var(--radius-md);">
            </div>
            <div class="form-group" style="flex: 1;">
                <label for="gender" style="font-weight: 600; color: var(--gray-700); margin-bottom: 0.5rem; display: block;">Gender</label>
                <select name="gender" id="gender" class="form-control"
                    style="width: 100%; padding: 0.75rem; border: 1px solid var(--gray-200); border-radius: var(--radius-md); background: white;">
                    <option value="" disabled selected>Select Gender</option>
                    <option value="Male">Male</option>
                    <option value="Female">Female</option>
                    <option value="Other">Other</option>
                </select>
            </div>
        </div>

        <div class="form-group" style="margin-top: 1.5rem;">
            <label for="symptoms"
                style="font-weight: 600; color: var(--gray-700); margin-bottom: 0.5rem; display: block;">Symptoms
                Description (Optional)</label>
            <textarea name="symptoms" id="symptoms" rows="3" class="form-control"
                placeholder="Describe any itching, pain, or duration..."
                style="width: 100%; padding: 0.75rem; border: 1px solid var(--gray-200); border-radius: var(--radius-md); font-family: inherit; resize: vertical;"></textarea>
        </div>

        <button type="submit" class="btn btn-primary btn-lg"
            style="width: 100%; margin-top: 2rem; justify-content: center;">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M2 12h20"></path>
                <path d="M20 12v6a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2v-6"></path>
                <path d="M12 2v10"></path>
                <path d="M9 5l3-3 3 3"></path>
            </svg>
            Analyze Image
        </button>
    </form>

    <script>
        // Enhanced preview logic inside the template to toggle placeholder
        const fileInput = document.getElementById('file');
        const preview = document.getElementById('preview');
        const placeholder = document.getElementById('upload-placeholder');

        fileInput.addEventListener('change', function (e) {
            if (e.target.files && e.target.files[0]) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    preview.src = e.target.result;
                    preview.style.display = 'block';
                    placeholder.style.display = 'none';
                }
                reader.readAsDataURL(e.target.files[0]);
            }
        });
    </script>
</div>
{% endblock %}